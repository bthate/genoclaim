#!/usr/bin/python3 -u
# GENOCLAIM - https://genoclaim.rtfd.io - OTP-CR-117_19 - otp.informationdesk@icc-cpi.int
#
# bin/genoclaimirc (genoclaim irc bot)

import os,sys ; sys.path.insert(0, os.path.join(os.getcwd()))

import lo
import os

from lo.csl import Console
from lo.shl import execute, level, parse_cli
from lo.hdl import Command

from bot import k, __version__

opts = [
    ('-s', '--shell', 'store_true', False, 'start a shell', 'shell'),
    ('-m', '--modules', 'store', str, "", 'modules to load.', 'modules'),
    ('-w', '--workdir', 'store', str, os.path.join(os.path.expanduser("~/.bot")), 'set working directory.', 'workdir'),
    ('-l', '--loglevel', 'store', str, "error", 'set loglevel.', 'level'),
    ('-a', '--logfile', 'store', str, os.path.join(os.path.expanduser("~/.bot"), "logs", "bot.log"), 'file to log to.', 'logfile'),
]

def main():
    parse_cli("genoclaimirc", __version__, opts, """\n\n1) genoclaim <cmd>\n2) genoclaim -s <server> <channel> <nick>""")
    level(lo.cfg.level, lo.cfg.logfile)
    lo.cfg.modules += ",bot.shw,bot.irc,genoclaim"
    if not k.start(True):
        return
    k.wait()
    
execute(main)
os._exit(0)
